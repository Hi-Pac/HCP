<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุดุฑูุฉ ุงูุฏูุงูุงุช | ูุธุงู ุฅุฏุงุฑุฉ ุงููุจูุนุงุช</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        dark: {
                            bg: '#181818',
                            text: '#ffffff'
                        }
                    }
                }
            }
        }
        
        // ุงูุชุญูู ูู ูุถุน ุงูุฃููุงู ุงูููุถู
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-storage-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Tajawal', sans-serif;
        }
        
        .dark {
            background-color: #181818;
            color: #ffffff;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-dark-bg min-h-screen">
    <div id="app">
        <!-- ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู -->
        <div id="login-page" class="flex items-center justify-center min-h-screen">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 w-full max-w-md">
                <div class="text-center mb-8">
                    <h1 class="text-3xl font-bold text-primary mb-2">ูุธุงู ุฅุฏุงุฑุฉ ูุจูุนุงุช ุงูุฏูุงูุงุช</h1>
                    <p class="text-gray-600 dark:text-gray-300">ูุฑุฌู ุชุณุฌูู ุงูุฏุฎูู ูููุตูู ุฅูู ุงููุธุงู</p>
                </div>
                
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" id="email" name="email" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                    </div>
                    
                    <div>
                        <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ูููุฉ ุงููุฑูุฑ</label>
                        <input type="password" id="password" name="password" class="w-full px-4 py-3 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                    </div>
                    
                    <div>
                        <button type="submit" class="w-full bg-primary text-white py-3 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                            ุชุณุฌูู ุงูุฏุฎูู
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- ุตูุญุฉ ููุญุฉ ุงูุชุญูู (ุณูุชู ุฅุธูุงุฑูุง ุจุนุฏ ุชุณุฌูู ุงูุฏุฎูู) -->
        <div id="dashboard-page" class="hidden">
            <div class="flex h-screen bg-gray-100 dark:bg-dark-bg">
                <!-- ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ -->
                <div id="sidebar" class="w-64 bg-white dark:bg-gray-800 shadow-lg">
                    <div class="p-4 border-b border-gray-200 dark:border-gray-700">
                        <h2 class="text-xl font-bold text-primary">ุดุฑูุฉ ุงูุฏูุงูุงุช</h2>
                    </div>
                    <nav class="mt-4">
                        <ul>
                            <li>
                                <a href="#dashboard" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 active-nav">
                                    <span class="mr-2">๐</span>
                                    <span>ููุญุฉ ุงูุชุญูู</span>
                                </a>
                            </li>
                            <li>
                                <a href="#products" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐จ</span>
                                    <span>ุงูููุชุฌุงุช</span>
                                </a>
                            </li>
                            <li>
                                <a href="#customers" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐ฅ</span>
                                    <span>ุงูุนููุงุก</span>
                                </a>
                            </li>
                            <li>
                                <a href="#orders" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐</span>
                                    <span>ุงูุทูุจุงุช</span>
                                </a>
                            </li>
                            <li>
                                <a href="#payments" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐ฐ</span>
                                    <span>ุงูุณุฏุงุฏ</span>
                                </a>
                            </li>
                            <li>
                                <a href="#reports" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐</span>
                                    <span>ุงูุชูุงุฑูุฑ</span>
                                </a>
                            </li>
                            <li id="admin-users-link" class="hidden">
                                <a href="#users" class="nav-link flex items-center px-4 py-3 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700">
                                    <span class="mr-2">๐ค</span>
                                    <span>ุงููุณุชุฎุฏููู</span>
                                </a>
                            </li>
                        </ul>
                    </nav>
                    <div class="absolute bottom-0 w-64 border-t border-gray-200 dark:border-gray-700">
                        <div class="p-4">
                            <div class="flex items-center">
                                <div class="w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center">
                                    <span id="user-initials">AM</span>
                                </div>
                                <div class="mr-3">
                                    <h4 id="user-name" class="text-sm font-medium text-gray-700 dark:text-gray-200">ุงุณู ุงููุณุชุฎุฏู</h4>
                                    <p id="user-role" class="text-xs text-gray-500 dark:text-gray-400">ุงูุฏูุฑ</p>
                                </div>
                            </div>
                            <button id="logout-btn" class="mt-4 w-full bg-red-500 text-white py-2 px-4 rounded-md font-medium hover:bg-red-600 transition-all">
                                ุชุณุฌูู ุงูุฎุฑูุฌ
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- ุงููุญุชูู ุงูุฑุฆูุณู -->
                <div class="flex-1 overflow-y-auto">
                    <header class="bg-white dark:bg-gray-800 shadow-sm">
                        <div class="max-w-7xl px-4 sm:px-6 lg:px-8 py-4">
                            <h1 id="page-title" class="text-xl font-bold text-gray-900 dark:text-white">ููุญุฉ ุงูุชุญูู</h1>
                        </div>
                    </header>
                    
                    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                        <!-- ูุญุชูู ุตูุญุงุช ุงูุชุทุจูู -->
                        <div id="dashboard-content" class="page-content">
                            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                                    <h3 class="text-lg font-medium text-gray-700 dark:text-gray-200 mb-2">ุฅุฌูุงูู ุงููุจูุนุงุช</h3>
                                    <p class="text-3xl font-bold text-primary">0</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                                    <h3 class="text-lg font-medium text-gray-700 dark:text-gray-200 mb-2">ุนุฏุฏ ุงูุทูุจุงุช</h3>
                                    <p class="text-3xl font-bold text-primary">0</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                                    <h3 class="text-lg font-medium text-gray-700 dark:text-gray-200 mb-2">ุนุฏุฏ ุงูุนููุงุก</h3>
                                    <p class="text-3xl font-bold text-primary">0</p>
                                </div>
                                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                                    <h3 class="text-lg font-medium text-gray-700 dark:text-gray-200 mb-2">ุนุฏุฏ ุงูููุชุฌุงุช</h3>
                                    <p class="text-3xl font-bold text-primary">0</p>
                                </div>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6">
                                <h3 class="text-lg font-medium text-gray-700 dark:text-gray-200 mb-4">ุงููุจูุนุงุช ุงูุดูุฑูุฉ</h3>
                                <div class="h-64 bg-gray-100 dark:bg-gray-700 rounded-lg flex items-center justify-center">
                                    <p class="text-gray-500 dark:text-gray-400">ุฑุณู ุจูุงูู ูููุจูุนุงุช ุณูุธูุฑ ููุง</p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="products-content" class="page-content hidden">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-xl font-bold text-gray-800 dark:text-white">ูุงุฆูุฉ ุงูููุชุฌุงุช</h2>
                                <button id="add-product-btn" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                                    ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
                                </button>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                                <div class="p-4">
                                    <div class="flex flex-col md:flex-row gap-3">
                                        <div class="flex-1">
                                            <input type="text" id="product-search" placeholder="ุจุญุซ ุนู ููุชุฌ..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                        </div>
                                        <div>
                                            <select id="product-category-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                                <option value="">ุฌููุน ุงูุชุตูููุงุช</option>
                                                <option value="ุฅูุดุงุฆู">ุฅูุดุงุฆู</option>
                                                <option value="ูุงุฌูุงุช ุฎุงุฑุฌูุฉ">ูุงุฌูุงุช ุฎุงุฑุฌูุฉ</option>
                                                <option value="ุฏูููุฑู">ุฏูููุฑู</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุชุตููู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงุณู ุงูููุชุฌ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูููู/ุงูุจุงุชุด</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุณุนุฑ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุฅุฌุฑุงุกุงุช</th>
                                            </tr>
                                        </thead>
                                        <tbody id="products-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td colspan="5" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ููุชุฌุงุช ุจุนุฏ</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div id="customers-content" class="page-content hidden">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-xl font-bold text-gray-800 dark:text-white">ูุงุฆูุฉ ุงูุนููุงุก</h2>
                                <button id="add-customer-btn" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                                    ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ
                                </button>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                                <div class="p-4">
                                    <div class="flex flex-col md:flex-row gap-3">
                                        <div class="flex-1">
                                            <input type="text" id="customer-search" placeholder="ุจุญุซ ุนู ุนููู..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                        </div>
                                        <div>
                                            <select id="customer-type-filter" class="px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                                <option value="">ุฌููุน ุงูุชุตูููุงุช</option>
                                                <option value="ููุฆุงุช/ูุดุงุฑูุน">ููุฆุงุช/ูุดุงุฑูุน</option>
                                                <option value="ูุญูุงุช">ูุญูุงุช</option>
                                                <option value="ุฃูุงูู">ุฃูุงูู</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุงุณู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุฑูู ุงููุงุชู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุนููุงู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุชุตููู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ูุณุจุฉ ุงูุฎุตู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุฅุฌุฑุงุกุงุช</th>
                                            </tr>
                                        </thead>
                                        <tbody id="customers-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ุนููุงุก ุจุนุฏ</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div id="orders-content" class="page-content hidden">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-xl font-bold text-gray-800 dark:text-white">ูุงุฆูุฉ ุงูุทูุจุงุช</h2>
                                <button id="add-order-btn" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                                    ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ
                                </button>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                                <div class="p-4">
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                                        <div>
                                            <input type="text" id="order-search" placeholder="ุจุญุซ ุนู ุทูุจ..." class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                        </div>
                                        <div>
                                            <input type="date" id="order-date-from" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                        </div>
                                        <div>
                                            <input type="date" id="order-date-to" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุฑูู ุงูุทูุจ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุชุงุฑูุฎ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุนููู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงููุจูุบ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุทุฑููุฉ ุงูุฏูุน</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุฅุฌุฑุงุกุงุช</th>
                                            </tr>
                                        </thead>
                                        <tbody id="orders-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ุทูุจุงุช ุจุนุฏ</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ูุญุชููุงุช ุงูุตูุญุงุช ุงูุฃุฎุฑู -->
                        <div id="payments-content" class="page-content hidden">
                            <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">ุณุฏุงุฏ ุงูุนููุงุก</h2>
                            <!-- ูุญุชูู ุตูุญุฉ ุงูุณุฏุงุฏ -->
                        </div>
                        
                        <div id="reports-content" class="page-content hidden">
                            <h2 class="text-xl font-bold text-gray-800 dark:text-white mb-6">ุงูุชูุงุฑูุฑ</h2>
                            <!-- ูุญุชูู ุตูุญุฉ ุงูุชูุงุฑูุฑ -->
                        </div>
                        
                        <div id="users-content" class="page-content hidden">
                            <div class="flex justify-between items-center mb-6">
                                <h2 class="text-xl font-bold text-gray-800 dark:text-white">ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู</h2>
                                <button id="add-user-btn" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                                    ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ
                                </button>
                            </div>
                            
                            <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                        <thead class="bg-gray-50 dark:bg-gray-700">
                                            <tr>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุงุณู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุฏูุฑ</th>
                                                <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">ุงูุฅุฌุฑุงุกุงุช</th>
                                            </tr>
                                        </thead>
                                        <tbody id="users-table-body" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                            <tr>
                                                <td colspan="4" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ูุณุชุฎุฏููู ุขุฎุฑูู ุจุนุฏ</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ -->
    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white" id="product-modal-title">ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">
                    <span class="text-2xl">&times;</span>
                </button>
            </div>
            
            <form id="product-form" class="space-y-4">
                <input type="hidden" id="product-id">
                <div>
                    <label for="product-category" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุชุตููู</label>
                    <select id="product-category" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                        <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                        <option value="ุฅูุดุงุฆู">ุฅูุดุงุฆู</option>
                        <option value="ูุงุฌูุงุช ุฎุงุฑุฌูุฉ">ูุงุฌูุงุช ุฎุงุฑุฌูุฉ</option>
                        <option value="ุฏูููุฑู">ุฏูููุฑู</option>
                    </select>
                </div>
                
                <div>
                    <label for="product-name" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงุณู ุงูููุชุฌ</label>
                    <input type="text" id="product-name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="product-batch" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูููู/ุงูุจุงุชุด</label>
                    <input type="text" id="product-batch" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="product-price" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุณุนุฑ</label>
                    <input type="number" id="product-price" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div class="flex justify-end pt-4">
                    <button type="button" class="modal-close bg-gray-200 text-gray-800 py-2 px-4 rounded-md font-medium hover:bg-gray-300 transition-all ml-2">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                        ุญูุธ
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ -->
    <div id="customer-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white" id="customer-modal-title">ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">
                    <span class="text-2xl">&times;</span>
                </button>
            </div>
            
            <form id="customer-form" class="space-y-4">
                <input type="hidden" id="customer-id">
                <div>
                    <label for="customer-name" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงุณู ุงูุนููู</label>
                    <input type="text" id="customer-name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="customer-phone" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุฑูู ุงููุงุชู</label>
                    <input type="text" id="customer-phone" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="customer-address" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุนููุงู</label>
                    <input type="text" id="customer-address" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="customer-type" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุชุตููู ุงูุนููู</label>
                    <select id="customer-type" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                        <option value="">ุงุฎุชุฑ ุงูุชุตููู</option>
                        <option value="ููุฆุงุช/ูุดุงุฑูุน">ููุฆุงุช/ูุดุงุฑูุน</option>
                        <option value="ูุญูุงุช">ูุญูุงุช</option>
                        <option value="ุฃูุงูู">ุฃูุงูู</option>
                    </select>
                </div>
                
                <div>
                    <label for="customer-discount" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ูุณุจุฉ ุงูุฎุตู (%)</label>
                    <input type="number" id="customer-discount" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" min="0" max="100" value="0">
                </div>
                
                <div class="flex justify-end pt-4">
                    <button type="button" class="modal-close bg-gray-200 text-gray-800 py-2 px-4 rounded-md font-medium hover:bg-gray-300 transition-all ml-2">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                        ุญูุธ
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ -->
    <div id="order-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-4xl max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white" id="order-modal-title">ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">
                    <span class="text-2xl">&times;</span>
                </button>
            </div>
            
            <form id="order-form" class="space-y-4">
                <input type="hidden" id="order-id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="order-number" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุฑูู ุงูุทูุจ</label>
                        <input type="text" id="order-number" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" readonly>
                    </div>
                    
                    <div>
                        <label for="order-date" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุชุงุฑูุฎ ุงูุทูุจ</label>
                        <input type="date" id="order-date" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                    </div>
                    
                    <div>
                        <label for="order-customer" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุนููู</label>
                        <select id="order-customer" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                            <option value="">ุงุฎุชุฑ ุงูุนููู</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="order-payment-method" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุทุฑููุฉ ุงูุฏูุน</label>
                        <select id="order-payment-method" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                            <option value="">ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน</option>
                            <option value="ููุฏู">ููุฏู</option>
                            <option value="ุชุญููู ุจููู">ุชุญููู ุจููู</option>
                            <option value="ุดูู">ุดูู</option>
                            <option value="ููุฏุงููู ูุงุด">ููุฏุงููู ูุงุด</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <div class="flex justify-between items-center">
                        <h4 class="text-md font-medium text-gray-900 dark:text-white mb-2">ุงูููุชุฌุงุช</h4>
                        <button type="button" id="add-product-item" class="bg-primary text-white py-1 px-3 rounded-md font-medium hover:bg-opacity-90 transition-all text-sm">
                            ุฅุถุงูุฉ ููุชุฌ
                        </button>
                    </div>
                    
                    <div id="order-products">
                        <div class="order-product-item bg-gray-50 dark:bg-gray-700 p-3 rounded-md mb-2">
                            <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                                <div class="md:col-span-2">
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูููุชุฌ</label>
                                    <select class="order-product-select w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                                        <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููููุฉ</label>
                                    <input type="number" class="order-product-quantity w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" value="1" min="1" required>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุณุนุฑ</label>
                                    <input type="number" class="order-product-price w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" readonly>
                                </div>
                                
                                <div class="flex items-end">
                                    <button type="button" class="remove-product-item bg-red-500 text-white py-2 px-3 rounded-md font-medium hover:bg-red-600 transition-all">
                                        ุญุฐู
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label for="order-notes" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ููุงุญุธุงุช</label>
                    <textarea id="order-notes" rows="3" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary"></textarea>
                </div>
                
                <div class="flex items-center">
                    <input type="checkbox" id="has-deposit" class="w-4 h-4 text-primary">
                    <label for="has-deposit" class="mr-2 block text-sm font-medium text-gray-700 dark:text-gray-200">ุนุฑุจูู</label>
                </div>
                
                <div id="deposit-section" class="hidden grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="deposit-amount" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ูููุฉ ุงูุนุฑุจูู</label>
                        <input type="number" id="deposit-amount" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" min="0">
                    </div>
                    
                    <div>
                        <label for="deposit-method" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุทุฑููุฉ ุฏูุน ุงูุนุฑุจูู</label>
                        <select id="deposit-method" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary">
                            <option value="ููุฏู">ููุฏู</option>
                            <option value="ุชุญููู ุจููู">ุชุญููู ุจููู</option>
                            <option value="ุดูู">ุดูู</option>
                            <option value="ููุฏุงููู ูุงุด">ููุฏุงููู ูุงุด</option>
                        </select>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-md">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููุจูุบ ูุจู ุงูุฎุตู</label>
                        <div id="order-subtotal" class="text-xl font-bold text-primary">0.00 ุฌ.ู</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุฎุตู</label>
                        <div id="order-discount" class="text-xl font-bold text-gray-600 dark:text-gray-300">0.00 ุฌ.ู</div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููุจูุบ ุจุนุฏ ุงูุฎุตู</label>
                        <div id="order-total" class="text-xl font-bold text-primary">0.00 ุฌ.ู</div>
                    </div>
                </div>
                
                <div class="flex justify-end pt-4">
                    <button type="button" class="modal-close bg-gray-200 text-gray-800 py-2 px-4 rounded-md font-medium hover:bg-gray-300 transition-all ml-2">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                        ุญูุธ
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ -->
    <div id="user-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-md">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white" id="user-modal-title">ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ</h3>
                <button class="modal-close text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white">
                    <span class="text-2xl">&times;</span>
                </button>
            </div>
            
            <form id="user-form" class="space-y-4">
                <div>
                    <label for="user-display-name" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงุณู ุงููุณุชุฎุฏู</label>
                    <input type="text" id="user-display-name" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="user-email" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="user-email" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="user-password" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="user-password" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                
                <div>
                    <label for="user-role" class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุฏูุฑ</label>
                    <select id="user-role" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                        <option value="supervisor">ูุดุฑู (Supervisor)</option>
                        <option value="user">ูุณุชุฎุฏู ุนุงุฏู (User)</option>
                    </select>
                </div>
                
                <div class="flex justify-end pt-4">
                    <button type="button" class="modal-close bg-gray-200 text-gray-800 py-2 px-4 rounded-md font-medium hover:bg-gray-300 transition-all ml-2">
                        ุฅูุบุงุก
                    </button>
                    <button type="submit" class="bg-primary text-white py-2 px-4 rounded-md font-medium hover:bg-opacity-90 transition-all">
                        ุญูุธ
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ุชุทุจูู Firebase -->
    <script>
        // ุชููุฆุฉ Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCpTjPsfaWTuNjpUupteqALjmb0qLUAzg8",
            authDomain: "delta-hcp.firebaseapp.com",
            projectId: "delta-hcp",
            storageBucket: "delta-hcp.firebasestorage.app",
            messagingSenderId: "956838180358",
            appId: "1:956838180358:web:af6abd7a430a8e17c83587",
            measurementId: "G-NJT5FCNJK3"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // ุญุงูุฉ ุงูุชุทุจูู
        let currentUser = null;
        let products = [];
        let customers = [];
        let orders = [];
        let users = [];
        
        // ุชุณุฌูู ุงูุฏุฎูู
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ
                    Swal.fire({
                        title: 'ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                })
                .catch((error) => {
                    Swal.fire({
                        title: 'ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู',
                        text: 'ูุฑุฌู ุงูุชุญูู ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููููุฉ ุงููุฑูุฑ',
                        icon: 'error'
                    });
                    console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู:', error);
                });
        });
        
        // ุญุฏุซ ุชุบููุฑ ุญุงูุฉ ุงููุณุชุฎุฏู
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                currentUser = user;
                console.log('ุชู ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู:', user.email);
                
                // ุฅุธูุงุฑ ุตูุญุฉ ููุญุฉ ุงูุชุญูู ูุฅุฎูุงุก ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
                document.getElementById('login-page').classList.add('hidden');
                document.getElementById('dashboard-page').classList.remove('hidden');
                
                // ุฌูุจ ูุนูููุงุช ุงููุณุชุฎุฏู ูู Firestore
                try {
                    const userDoc = await db.collection('users').doc(user.uid).get();
                    if (userDoc.exists) {
                        const userData = userDoc.data();
                        document.getElementById('user-name').textContent = userData.displayName || user.email;
                        document.getElementById('user-role').textContent = getUserRoleText(userData.role);
                        document.getElementById('user-initials').textContent = getInitials(userData.displayName || user.email);
                        
                        // ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
                        if (userData.role === 'admin') {
                            // ุฅุธูุงุฑ ุฑุงุจุท ุงููุณุชุฎุฏููู ูููุณุคูู ููุท
                            document.getElementById('admin-users-link').classList.remove('hidden');
                        }
                    } else {
                        // ุฅูุดุงุก ูุซููุฉ ูููุณุชุฎุฏู ุฅุฐุง ูู ุชูู ููุฌูุฏุฉ
                        if (user.email === 'tego0o12@gmail.com') {
                            await db.collection('users').doc(user.uid).set({
                                displayName: 'ุงููุฏูุฑ',
                                email: user.email,
                                role: 'admin',
                                createdAt: firebase.firestore.Timestamp.now()
                            });
                            document.getElementById('user-name').textContent = 'ุงููุฏูุฑ';
                            document.getElementById('user-role').textContent = 'ูุฏูุฑ ุงููุธุงู';
                            document.getElementById('user-initials').textContent = 'ู';
                            document.getElementById('admin-users-link').classList.remove('hidden');
                        } else {
                            document.getElementById('user-name').textContent = user.email;
                            document.getElementById('user-role').textContent = 'ูุณุชุฎุฏู ุนุงุฏู';
                            document.getElementById('user-initials').textContent = getInitials(user.email);
                        }
                    }
                } catch (error) {
                    console.error('ุฎุทุฃ ูู ุฌูุจ ุจูุงูุงุช ุงููุณุชุฎุฏู:', error);
                }
                
                // ุชุญููู ุงูุจูุงูุงุช
                loadProducts();
                loadCustomers();
                loadOrders();
                loadUsers();
                
            } else {
                // ุงููุณุชุฎุฏู ุบูุฑ ูุณุฌู ุงูุฏุฎูู
                currentUser = null;
                document.getElementById('dashboard-page').classList.add('hidden');
                document.getElementById('login-page').classList.remove('hidden');
            }
        });
        
        // ุชุณุฌูู ุงูุฎุฑูุฌ
        document.getElementById('logout-btn').addEventListener('click', function() {
            auth.signOut().then(() => {
                console.log('ุชู ุชุณุฌูู ุงูุฎุฑูุฌ');
                Swal.fire({
                    title: 'ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ',
                    icon: 'success',
                    timer: 1500,
                    showConfirmButton: false
                });
            }).catch((error) => {
                console.error('ุฎุทุฃ ูู ุชุณุฌูู ุงูุฎุฑูุฌ:', error);
            });
        });
        
        // =====================
        // ุงูุชููู ุจูู ุงูุตูุญุงุช
        // =====================
        const navLinks = document.querySelectorAll('.nav-link');
        const pageContents = document.querySelectorAll('.page-content');
        
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                
                // ุฅุฒุงูุฉ ุงููุฆุฉ ุงููุดุทุฉ ูู ุฌููุน ุงูุฑูุงุจุท
                navLinks.forEach(l => l.classList.remove('active-nav', 'bg-gray-100', 'dark:bg-gray-700', 'text-primary'));
                
                // ุฅุถุงูุฉ ุงููุฆุฉ ุงููุดุทุฉ ุฅูู ุงูุฑุงุจุท ุงูุญุงูู
                this.classList.add('active-nav', 'bg-gray-100', 'dark:bg-gray-700', 'text-primary');
                
                // ุฅุฎูุงุก ุฌููุน ุงูุตูุญุงุช
                pageContents.forEach(content => content.classList.add('hidden'));
                
                // ุงุณุชุฎุฑุงุฌ ูุนุฑู ุงูุตูุญุฉ ูู ุงูุฑุงุจุท ูุฅุธูุงุฑูุง
                const targetId = this.getAttribute('href').substring(1);
                document.getElementById(`${targetId}-content`).classList.remove('hidden');
                
                // ุชุญุฏูุซ ุนููุงู ุงูุตูุญุฉ
                const pageTitle = this.querySelector('span:last-child').textContent;
                document.getElementById('page-title').textContent = pageTitle;
            });
        });
        
        // =====================
        // ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช - ุงูููุชุฌุงุช
        // =====================
        function loadProducts() {
            db.collection('products').get().then((querySnapshot) => {
                products = [];
                querySnapshot.forEach((doc) => {
                    products.push({ id: doc.id, ...doc.data() });
                });
                
                renderProductsTable();
                updateProductOptions();
                
                // ุชุญุฏูุซ ุนุฏุฏ ุงูููุชุฌุงุช ูู ููุญุฉ ุงูุชุญูู
                updateDashboardCounts();
            }).catch((error) => {
                console.error('ุฎุทุฃ ูู ุฌูุจ ุงูููุชุฌุงุช:', error);
            });
        }
        
        function renderProductsTable() {
            const tableBody = document.getElementById('products-table-body');
            
            if (products.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ููุชุฌุงุช ุจุนุฏ</td></tr>`;
                return;
            }
            
            let html = '';
            products.forEach(product => {
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.batch}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.price} ุฌ.ู</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="edit-product-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${product.id}">ุชุนุฏูู</button>
                        <button class="delete-product-btn text-red-500 hover:text-red-700" data-id="${product.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุฃุฒุฑุงุฑ ุงูุชุนุฏูู ูุงูุญุฐู
            document.querySelectorAll('.edit-product-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    editProduct(productId);
                });
            });
            
            document.querySelectorAll('.delete-product-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    deleteProduct(productId);
                });
            });
        }
        
        // ููุชุฑุฉ ุงูููุชุฌุงุช
        document.getElementById('product-search').addEventListener('input', function() {
            filterProducts();
        });
        
        document.getElementById('product-category-filter').addEventListener('change', function() {
            filterProducts();
        });
        
        function filterProducts() {
            const searchTerm = document.getElementById('product-search').value.trim().toLowerCase();
            const categoryFilter = document.getElementById('product-category-filter').value;
            
            const tableBody = document.getElementById('products-table-body');
            
            const filteredProducts = products.filter(product => {
                const matchesSearch = 
                    product.name.toLowerCase().includes(searchTerm) || 
                    product.batch.toLowerCase().includes(searchTerm) ||
                    product.category.toLowerCase().includes(searchTerm);
                
                const matchesCategory = !categoryFilter || product.category === categoryFilter;
                
                return matchesSearch && matchesCategory;
            });
            
            if (filteredProducts.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="5" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ููุชุฌุงุช ุชุทุงุจู ุงูุจุญุซ</td></tr>`;
                return;
            }
            
            let html = '';
            filteredProducts.forEach(product => {
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.category}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.batch}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${product.price} ุฌ.ู</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="edit-product-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${product.id}">ุชุนุฏูู</button>
                        <button class="delete-product-btn text-red-500 hover:text-red-700" data-id="${product.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุนุงุฏุฉ ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ
            document.querySelectorAll('.edit-product-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    editProduct(productId);
                });
            });
            
            document.querySelectorAll('.delete-product-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const productId = this.getAttribute('data-id');
                    deleteProduct(productId);
                });
            });
        }
        
        // ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
        document.getElementById('add-product-btn').addEventListener('click', function() {
            // ุฅุนุงุฏุฉ ุชุนููู ูููุฐุฌ ุงูููุชุฌ
            document.getElementById('product-form').reset();
            document.getElementById('product-id').value = '';
            document.getElementById('product-modal-title').textContent = 'ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ';
            
            // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ
            document.getElementById('product-modal').classList.remove('hidden');
        });
        
        // ุฅุบูุงู ุงููุงูุฐุฉ ุงูููุจุซูุฉ
        document.querySelectorAll('.modal-close').forEach(btn => {
            btn.addEventListener('click', function() {
                // ุงูุญุตูู ุนูู ุงููุงูุฐุฉ ุงูููุจุซูุฉ ุงูุฃูุฑุจ
                const modal = this.closest('.fixed');
                if (modal) {
                    modal.classList.add('hidden');
                }
            });
        });
        
        // ุญูุธ ุงูููุชุฌ
        document.getElementById('product-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const productId = document.getElementById('product-id').value;
            const category = document.getElementById('product-category').value;
            const name = document.getElementById('product-name').value;
            const batch = document.getElementById('product-batch').value;
            const price = parseFloat(document.getElementById('product-price').value);
            
            const productData = {
                category,
                name,
                batch,
                price,
                updatedAt: firebase.firestore.Timestamp.now()
            };
            
            if (productId) {
                // ุชุญุฏูุซ ููุชุฌ ููุฌูุฏ
                db.collection('products').doc(productId).update(productData)
                    .then(() => {
                        console.log('ุชู ุชุญุฏูุซ ุงูููุชุฌ ุจูุฌุงุญ');
                        loadProducts();
                        document.getElementById('product-modal').classList.add('hidden');
                        Swal.fire({
                            title: 'ุชู ุงูุชุญุฏูุซ',
                            text: 'ุชู ุชุญุฏูุซ ุงูููุชุฌ ุจูุฌุงุญ',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                    })
                    .catch((error) => {
                        console.error('ุฎุทุฃ ูู ุชุญุฏูุซ ุงูููุชุฌ:', error);
                        Swal.fire({
                            title: 'ุฎุทุฃ',
                            text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุฏูุซ ุงูููุชุฌ',
                            icon: 'error'
                        });
                    });
            } else {
                // ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ
                productData.createdAt = firebase.firestore.Timestamp.now();
                
                db.collection('products').add(productData)
                    .then(() => {
                        console.log('ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ');
                        loadProducts();
                        document.getElementById('product-modal').classList.add('hidden');
                        Swal.fire({
                            title: 'ุชูุช ุงูุฅุถุงูุฉ',
                            text: 'ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                    })
                    .catch((error) => {
                        console.error('ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูููุชุฌ:', error);
                        Swal.fire({
                            title: 'ุฎุทุฃ',
                            text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุถุงูุฉ ุงูููุชุฌ',
                            icon: 'error'
                        });
                    });
            }
        });
        
        // ุชุนุฏูู ููุชุฌ
        function editProduct(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                document.getElementById('product-id').value = product.id;
                document.getElementById('product-category').value = product.category;
                document.getElementById('product-name').value = product.name;
                document.getElementById('product-batch').value = product.batch;
                document.getElementById('product-price').value = product.price;
                
                document.getElementById('product-modal-title').textContent = 'ุชุนุฏูู ุงูููุชุฌ';
                document.getElementById('product-modal').classList.remove('hidden');
            }
        }
        
        // ุญุฐู ููุชุฌ
        function deleteProduct(productId) {
            Swal.fire({
                title: 'ูู ุฃูุช ูุชุฃูุฏุ',
                text: 'ูู ุชุชููู ูู ุงุณุชุนุงุฏุฉ ูุฐุง ุงูููุชุฌ!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'ูุนูุ ุงุญุฐูู!',
                cancelButtonText: 'ุฅูุบุงุก'
            }).then((result) => {
                if (result.isConfirmed) {
                    db.collection('products').doc(productId).delete()
                        .then(() => {
                            console.log('ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ');
                            loadProducts();
                            Swal.fire({
                                title: 'ุชู ุงูุญุฐู!',
                                text: 'ุชู ุญุฐู ุงูููุชุฌ ุจูุฌุงุญ.',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            });
                        })
                        .catch((error) => {
                            console.error('ุฎุทุฃ ูู ุญุฐู ุงูููุชุฌ:', error);
                            Swal.fire({
                                title: 'ุฎุทุฃ',
                                text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูููุชุฌ',
                                icon: 'error'
                            });
                        });
                }
            });
        }
        
        // =====================
        // ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช - ุงูุนููุงุก
        // =====================
        function loadCustomers() {
            db.collection('customers').get().then((querySnapshot) => {
                customers = [];
                querySnapshot.forEach((doc) => {
                    customers.push({ id: doc.id, ...doc.data() });
                });
                
                renderCustomersTable();
                updateCustomerOptions();
                
                // ุชุญุฏูุซ ุนุฏุฏ ุงูุนููุงุก ูู ููุญุฉ ุงูุชุญูู
                updateDashboardCounts();
            }).catch((error) => {
                console.error('ุฎุทุฃ ูู ุฌูุจ ุงูุนููุงุก:', error);
            });
        }
        
        function renderCustomersTable() {
            const tableBody = document.getElementById('customers-table-body');
            
            if (customers.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ุนููุงุก ุจุนุฏ</td></tr>`;
                return;
            }
            
            let html = '';
            customers.forEach(customer => {
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.phone}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.address}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.type}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.discount}%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="edit-customer-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${customer.id}">ุชุนุฏูู</button>
                        <button class="delete-customer-btn text-red-500 hover:text-red-700" data-id="${customer.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุฃุฒุฑุงุฑ ุงูุชุนุฏูู ูุงูุญุฐู
            document.querySelectorAll('.edit-customer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const customerId = this.getAttribute('data-id');
                    editCustomer(customerId);
                });
            });
            
            document.querySelectorAll('.delete-customer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const customerId = this.getAttribute('data-id');
                    deleteCustomer(customerId);
                });
            });
        }
        
        // ููุชุฑุฉ ุงูุนููุงุก
        document.getElementById('customer-search').addEventListener('input', function() {
            filterCustomers();
        });
        
        document.getElementById('customer-type-filter').addEventListener('change', function() {
            filterCustomers();
        });
        
        function filterCustomers() {
            const searchTerm = document.getElementById('customer-search').value.trim().toLowerCase();
            const typeFilter = document.getElementById('customer-type-filter').value;
            
            const tableBody = document.getElementById('customers-table-body');
            
            const filteredCustomers = customers.filter(customer => {
                const matchesSearch = 
                    customer.name.toLowerCase().includes(searchTerm) || 
                    customer.phone.includes(searchTerm) ||
                    customer.address.toLowerCase().includes(searchTerm);
                
                const matchesType = !typeFilter || customer.type === typeFilter;
                
                return matchesSearch && matchesType;
            });
            
            if (filteredCustomers.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ุนููุงุก ุชุทุงุจู ุงูุจุญุซ</td></tr>`;
                return;
            }
            
            let html = '';
            filteredCustomers.forEach(customer => {
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.name}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.phone}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.address}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.type}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customer.discount}%</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="edit-customer-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${customer.id}">ุชุนุฏูู</button>
                        <button class="delete-customer-btn text-red-500 hover:text-red-700" data-id="${customer.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุนุงุฏุฉ ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ
            document.querySelectorAll('.edit-customer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const customerId = this.getAttribute('data-id');
                    editCustomer(customerId);
                });
            });
            
            document.querySelectorAll('.delete-customer-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const customerId = this.getAttribute('data-id');
                    deleteCustomer(customerId);
                });
            });
        }
        
        // ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ
        document.getElementById('add-customer-btn').addEventListener('click', function() {
            // ุฅุนุงุฏุฉ ุชุนููู ูููุฐุฌ ุงูุนููู
            document.getElementById('customer-form').reset();
            document.getElementById('customer-id').value = '';
            document.getElementById('customer-modal-title').textContent = 'ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ';
            
            // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ
            document.getElementById('customer-modal').classList.remove('hidden');
        });
        
        // ุญูุธ ุงูุนููู
        document.getElementById('customer-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const customerId = document.getElementById('customer-id').value;
            const name = document.getElementById('customer-name').value;
            const phone = document.getElementById('customer-phone').value;
            const address = document.getElementById('customer-address').value;
            const type = document.getElementById('customer-type').value;
            const discount = parseInt(document.getElementById('customer-discount').value) || 0;
            
            const customerData = {
                name,
                phone,
                address,
                type,
                discount,
                updatedAt: firebase.firestore.Timestamp.now()
            };
            
            if (customerId) {
                // ุชุญุฏูุซ ุนููู ููุฌูุฏ
                db.collection('customers').doc(customerId).update(customerData)
                    .then(() => {
                        console.log('ุชู ุชุญุฏูุซ ุงูุนููู ุจูุฌุงุญ');
                        loadCustomers();
                        document.getElementById('customer-modal').classList.add('hidden');
                        Swal.fire({
                            title: 'ุชู ุงูุชุญุฏูุซ',
                            text: 'ุชู ุชุญุฏูุซ ุงูุนููู ุจูุฌุงุญ',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                    })
                    .catch((error) => {
                        console.error('ุฎุทุฃ ูู ุชุญุฏูุซ ุงูุนููู:', error);
                        Swal.fire({
                            title: 'ุฎุทุฃ',
                            text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุฏูุซ ุงูุนููู',
                            icon: 'error'
                        });
                    });
            } else {
                // ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ
                customerData.createdAt = firebase.firestore.Timestamp.now();
                
                db.collection('customers').add(customerData)
                    .then(() => {
                        console.log('ุชู ุฅุถุงูุฉ ุงูุนููู ุจูุฌุงุญ');
                        loadCustomers();
                        document.getElementById('customer-modal').classList.add('hidden');
                        Swal.fire({
                            title: 'ุชูุช ุงูุฅุถุงูุฉ',
                            text: 'ุชู ุฅุถุงูุฉ ุงูุนููู ุจูุฌุงุญ',
                            icon: 'success',
                            timer: 1500,
                            showConfirmButton: false
                        });
                    })
                    .catch((error) => {
                        console.error('ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูุนููู:', error);
                        Swal.fire({
                            title: 'ุฎุทุฃ',
                            text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุถุงูุฉ ุงูุนููู',
                            icon: 'error'
                        });
                    });
            }
        });
        
        // ุชุนุฏูู ุนููู
        function editCustomer(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (customer) {
                document.getElementById('customer-id').value = customer.id;
                document.getElementById('customer-name').value = customer.name;
                document.getElementById('customer-phone').value = customer.phone;
                document.getElementById('customer-address').value = customer.address;
                document.getElementById('customer-type').value = customer.type;
                document.getElementById('customer-discount').value = customer.discount;
                
                document.getElementById('customer-modal-title').textContent = 'ุชุนุฏูู ุงูุนููู';
                document.getElementById('customer-modal').classList.remove('hidden');
            }
        }
        
        // ุญุฐู ุนููู
        function deleteCustomer(customerId) {
            Swal.fire({
                title: 'ูู ุฃูุช ูุชุฃูุฏุ',
                text: 'ูู ุชุชููู ูู ุงุณุชุนุงุฏุฉ ูุฐุง ุงูุนููู!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'ูุนูุ ุงุญุฐูู!',
                cancelButtonText: 'ุฅูุบุงุก'
            }).then((result) => {
                if (result.isConfirmed) {
                    db.collection('customers').doc(customerId).delete()
                        .then(() => {
                            console.log('ุชู ุญุฐู ุงูุนููู ุจูุฌุงุญ');
                            loadCustomers();
                            Swal.fire({
                                title: 'ุชู ุงูุญุฐู!',
                                text: 'ุชู ุญุฐู ุงูุนููู ุจูุฌุงุญ.',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            });
                        })
                        .catch((error) => {
                            console.error('ุฎุทุฃ ูู ุญุฐู ุงูุนููู:', error);
                            Swal.fire({
                                title: 'ุฎุทุฃ',
                                text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุนููู',
                                icon: 'error'
                            });
                        });
                }
            });
        }
        
        function updateCustomerOptions() {
            const customerSelect = document.getElementById('order-customer');
            
            // ุญูุธ ุงููููุฉ ุงููุญุฏุฏุฉ ุงูุญุงููุฉ
            const currentValue = customerSelect.value;
            
            // ูุณุญ ุงูุฎูุงุฑุงุช ุงูุญุงููุฉ
            customerSelect.innerHTML = '<option value="">ุงุฎุชุฑ ุงูุนููู</option>';
            
            // ุฅุถุงูุฉ ุฎูุงุฑุงุช ุงูุนููุงุก
            customers.forEach(customer => {
                const option = document.createElement('option');
                option.value = customer.id;
                option.textContent = customer.name;
                option.dataset.discount = customer.discount;
                customerSelect.appendChild(option);
            });
            
            // ุงุณุชุนุงุฏุฉ ุงููููุฉ ุงููุญุฏุฏุฉ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
            if (currentValue && customers.some(c => c.id === currentValue)) {
                customerSelect.value = currentValue;
            }
        }
        
        // =====================
        // ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช - ุงูุทูุจุงุช
        // =====================
        function loadOrders() {
            db.collection('orders').orderBy('createdAt', 'desc').get().then((querySnapshot) => {
                orders = [];
                querySnapshot.forEach((doc) => {
                    orders.push({ id: doc.id, ...doc.data() });
                });
                
                renderOrdersTable();
                
                // ุชุญุฏูุซ ุนุฏุฏ ุงูุทูุจุงุช ูุงููุจูุนุงุช ูู ููุญุฉ ุงูุชุญูู
                updateDashboardCounts();
            }).catch((error) => {
                console.error('ุฎุทุฃ ูู ุฌูุจ ุงูุทูุจุงุช:', error);
            });
        }
        
        function renderOrdersTable() {
            const tableBody = document.getElementById('orders-table-body');
            
            if (orders.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ุทูุจุงุช ุจุนุฏ</td></tr>`;
                return;
            }
            
            let html = '';
            orders.forEach(order => {
                // ุงูุจุญุซ ุนู ุงูุนููู ููุญุตูู ุนูู ุงุณูู
                const customer = customers.find(c => c.id === order.customerId);
                const customerName = customer ? customer.name : 'ุบูุฑ ูุนุฑูู';
                
                // ุชูุณูู ุงูุชุงุฑูุฎ
                const orderDate = order.date ? new Date(order.date) : new Date();
                const formattedDate = orderDate.toLocaleDateString('ar-EG');
                
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.orderNumber}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${formattedDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customerName}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.totalAfterDiscount} ุฌ.ู</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.paymentMethod}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="view-order-btn text-green-500 hover:text-green-700 ml-2" data-id="${order.id}">ุนุฑุถ</button>
                        <button class="edit-order-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${order.id}">ุชุนุฏูู</button>
                        <button class="delete-order-btn text-red-500 hover:text-red-700" data-id="${order.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุฃุฒุฑุงุฑ ุงูุนุฑุถ ูุงูุชุนุฏูู ูุงูุญุฐู
            document.querySelectorAll('.view-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    viewOrder(orderId);
                });
            });
            
            document.querySelectorAll('.edit-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    editOrder(orderId);
                });
            });
            
            document.querySelectorAll('.delete-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    deleteOrder(orderId);
                });
            });
        }
        
        // ููุชุฑุฉ ุงูุทูุจุงุช
        document.getElementById('order-search').addEventListener('input', function() {
            filterOrders();
        });
        
        document.getElementById('order-date-from').addEventListener('change', function() {
            filterOrders();
        });
        
        document.getElementById('order-date-to').addEventListener('change', function() {
            filterOrders();
        });
        
        function filterOrders() {
            const searchTerm = document.getElementById('order-search').value.trim().toLowerCase();
            const dateFrom = document.getElementById('order-date-from').value;
            const dateTo = document.getElementById('order-date-to').value;
            
            const tableBody = document.getElementById('orders-table-body');
            
            const filteredOrders = orders.filter(order => {
                // ุงูุจุญุซ ุนู ุงูุนููู
                const customer = customers.find(c => c.id === order.customerId);
                const customerName = customer ? customer.name.toLowerCase() : '';
                
                // ุงูุชุญูู ูู ุงูุชุทุงุจู ูุน ูุตุทูุญ ุงูุจุญุซ
                const matchesSearch = 
                    order.orderNumber.toString().includes(searchTerm) || 
                    customerName.includes(searchTerm) ||
                    order.paymentMethod.toLowerCase().includes(searchTerm);
                
                // ุงูุชุญูู ูู ูุทุงู ุงูุชุงุฑูุฎ
                let matchesDateRange = true;
                const orderDate = new Date(order.date);
                
                if (dateFrom) {
                    const fromDate = new Date(dateFrom);
                    matchesDateRange = matchesDateRange && orderDate >= fromDate;
                }
                
                if (dateTo) {
                    const toDate = new Date(dateTo);
                    // ุถุจุท ููุช ููุงูุฉ ุงูููู ููุชุงุฑูุฎ "ุญุชู"
                    toDate.setHours(23, 59, 59, 999);
                    matchesDateRange = matchesDateRange && orderDate <= toDate;
                }
                
                return matchesSearch && matchesDateRange;
            });
            
            if (filteredOrders.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="6" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ุชูุฌุฏ ุทูุจุงุช ุชุทุงุจู ุงูุจุญุซ</td></tr>`;
                return;
            }
            
            let html = '';
            filteredOrders.forEach(order => {
                // ุงูุจุญุซ ุนู ุงูุนููู ููุญุตูู ุนูู ุงุณูู
                const customer = customers.find(c => c.id === order.customerId);
                const customerName = customer ? customer.name : 'ุบูุฑ ูุนุฑูู';
                
                // ุชูุณูู ุงูุชุงุฑูุฎ
                const orderDate = order.date ? new Date(order.date) : new Date();
                const formattedDate = orderDate.toLocaleDateString('ar-EG');
                
                html += `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.orderNumber}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${formattedDate}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${customerName}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.totalAfterDiscount} ุฌ.ู</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${order.paymentMethod}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                        <button class="view-order-btn text-green-500 hover:text-green-700 ml-2" data-id="${order.id}">ุนุฑุถ</button>
                        <button class="edit-order-btn text-blue-500 hover:text-blue-700 ml-2" data-id="${order.id}">ุชุนุฏูู</button>
                        <button class="delete-order-btn text-red-500 hover:text-red-700" data-id="${order.id}">ุญุฐู</button>
                    </td>
                </tr>
                `;
            });
            
            tableBody.innerHTML = html;
            
            // ุฅุนุงุฏุฉ ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ
            document.querySelectorAll('.view-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    viewOrder(orderId);
                });
            });
            
            document.querySelectorAll('.edit-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    editOrder(orderId);
                });
            });
            
            document.querySelectorAll('.delete-order-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const orderId = this.getAttribute('data-id');
                    deleteOrder(orderId);
                });
            });
        }
        
        // ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ
        document.getElementById('add-order-btn').addEventListener('click', function() {
            // ุฅุนุงุฏุฉ ุชุนููู ูููุฐุฌ ุงูุทูุจ
            document.getElementById('order-form').reset();
            document.getElementById('order-id').value = '';
            document.getElementById('order-modal-title').textContent = 'ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ';
            
            // ุชุนููู ุฑูู ุงูุทูุจ ุงูุฌุฏูุฏ ุจูุงุกู ุนูู ุขุฎุฑ ุทูุจ
            const nextOrderNumber = getNextOrderNumber();
            document.getElementById('order-number').value = nextOrderNumber;
            
            // ุชุนููู ุชุงุฑูุฎ ุงูููู
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('order-date').value = today;
            
            // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุชุฌุงุช
            updateProductOptions();
            
            // ูุณุญ ููุชุฌุงุช ุงูุทูุจ ูุชุฑู ุนูุตุฑ ูุงุญุฏ ูุงุฑุบ
            const orderProductsContainer = document.getElementById('order-products');
            orderProductsContainer.innerHTML = `
            <div class="order-product-item bg-gray-50 dark:bg-gray-700 p-3 rounded-md mb-2">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูููุชุฌ</label>
                        <select class="order-product-select w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                            <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููููุฉ</label>
                        <input type="number" class="order-product-quantity w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" value="1" min="1" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุณุนุฑ</label>
                        <input type="number" class="order-product-price w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" readonly>
                    </div>
                    
                    <div class="flex items-end">
                        <button type="button" class="remove-product-item bg-red-500 text-white py-2 px-3 rounded-md font-medium hover:bg-red-600 transition-all">
                            ุญุฐู
                        </button>
                    </div>
                </div>
            </div>
            `;
            
            // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุชุฌุงุช ูู ุงูุนูุตุฑ ุงูุฃูู
            updateProductSelectOptions(orderProductsContainer.querySelector('.order-product-select'));
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ููุญููู
            addOrderProductEventListeners();
            
            // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ
            document.getElementById('order-modal').classList.remove('hidden');
        });
        
        // ุฅุถุงูุฉ ููุชุฌ ุฌุฏูุฏ ุฅูู ุงูุทูุจ
        document.getElementById('add-product-item').addEventListener('click', function() {
            const orderProductsContainer = document.getElementById('order-products');
            
            const newProductItem = document.createElement('div');
            newProductItem.className = 'order-product-item bg-gray-50 dark:bg-gray-700 p-3 rounded-md mb-2';
            newProductItem.innerHTML = `
            <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูููุชุฌ</label>
                    <select class="order-product-select w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                        <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููููุฉ</label>
                    <input type="number" class="order-product-quantity w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" value="1" min="1" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุณุนุฑ</label>
                    <input type="number" class="order-product-price w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" readonly>
                </div>
                
                <div class="flex items-end">
                    <button type="button" class="remove-product-item bg-red-500 text-white py-2 px-3 rounded-md font-medium hover:bg-red-600 transition-all">
                        ุญุฐู
                    </button>
                </div>
            </div>
            `;
            
            orderProductsContainer.appendChild(newProductItem);
            
            // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุชุฌุงุช ูู ุงูุนูุตุฑ ุงูุฌุฏูุฏ
            updateProductSelectOptions(newProductItem.querySelector('.order-product-select'));
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ููุญููู ุงูุฌุฏูุฏุฉ
            addOrderProductEventListeners(newProductItem);
        });
        
        // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุญููู ููุชุฌุงุช ุงูุทูุจ
        function addOrderProductEventListeners(container = document) {
            container.querySelectorAll('.order-product-select').forEach(select => {
                if (!select.hasEventListener) {
                    select.addEventListener('change', function() {
                        const productId = this.value;
                        const productItem = this.closest('.order-product-item');
                        const priceInput = productItem.querySelector('.order-product-price');
                        
                        if (productId) {
                            const product = products.find(p => p.id === productId);
                            if (product) {
                                priceInput.value = product.price;
                            }
                        } else {
                            priceInput.value = '';
                        }
                        
                        calculateOrderTotals();
                    });
                    select.hasEventListener = true;
                }
            });
            
            container.querySelectorAll('.order-product-quantity').forEach(input => {
                if (!input.hasEventListener) {
                    input.addEventListener('input', function() {
                        calculateOrderTotals();
                    });
                    input.hasEventListener = true;
                }
            });
            
            container.querySelectorAll('.remove-product-item').forEach(btn => {
                if (!btn.hasEventListener) {
                    btn.addEventListener('click', function() {
                        const productItems = document.querySelectorAll('.order-product-item');
                        if (productItems.length > 1) {
                            const productItem = this.closest('.order-product-item');
                            productItem.remove();
                            calculateOrderTotals();
                        } else {
                            Swal.fire({
                                title: 'ุชูุจูู',
                                text: 'ูุฌุจ ุฃู ูุญุชูู ุงูุทูุจ ุนูู ููุชุฌ ูุงุญุฏ ุนูู ุงูุฃูู',
                                icon: 'warning'
                            });
                        }
                    });
                    btn.hasEventListener = true;
                }
            });
        }
        
        // ูุณู ุงูุนุฑุจูู
        document.getElementById('has-deposit').addEventListener('change', function() {
            const depositSection = document.getElementById('deposit-section');
            if (this.checked) {
                depositSection.classList.remove('hidden');
            } else {
                depositSection.classList.add('hidden');
                document.getElementById('deposit-amount').value = 0;
            }
            calculateOrderTotals();
        });
        
        document.getElementById('deposit-amount').addEventListener('input', function() {
            calculateOrderTotals();
        });
        
        // ุชุญุฏูุซ ุงุฎุชูุงุฑ ุงูุนููู
        document.getElementById('order-customer').addEventListener('change', function() {
            calculateOrderTotals();
        });
        
        // ุญุณุงุจ ุฅุฌูุงูู ุงูุทูุจ
        function calculateOrderTotals() {
            let subtotal = 0;
            let discount = 0;
            let total = 0;
            
            // ุญุณุงุจ ุงููุจูุบ ุงูุฅุฌูุงูู ูุจู ุงูุฎุตู
            document.querySelectorAll('.order-product-item').forEach(item => {
                const quantity = parseFloat(item.querySelector('.order-product-quantity').value) || 0;
                const price = parseFloat(item.querySelector('.order-product-price').value) || 0;
                subtotal += quantity * price;
            });
            
            // ุญุณุงุจ ุงูุฎุตู
            const customerSelect = document.getElementById('order-customer');
            const selectedOption = customerSelect.options[customerSelect.selectedIndex];
            if (selectedOption && selectedOption.value) {
                const customerDiscount = parseFloat(selectedOption.dataset.discount) || 0;
                discount = (subtotal * customerDiscount) / 100;
            }
            
            // ุญุณุงุจ ุงููุจูุบ ุจุนุฏ ุงูุฎุตู
            total = subtotal - discount;
            
            // ุทุฑุญ ุงูุนุฑุจูู ุฅู ูุฌุฏ
            const hasDeposit = document.getElementById('has-deposit').checked;
            if (hasDeposit) {
                const depositAmount = parseFloat(document.getElementById('deposit-amount').value) || 0;
                total -= depositAmount;
            }
            
            // ุชุญุฏูุซ ุงูุนุฑุถ
            document.getElementById('order-subtotal').textContent = formatCurrency(subtotal);
            document.getElementById('order-discount').textContent = formatCurrency(discount);
            document.getElementById('order-total').textContent = formatCurrency(total);
        }
        
        // ุชูุณูู ุงูุนููุฉ
        function formatCurrency(amount) {
            return amount.toFixed(2) + ' ุฌ.ู';
        }
        
        // ุญูุธ ุงูุทูุจ
        document.getElementById('order-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // ุงูุชุญูู ูู ูุฌูุฏ ุนููู ูููุชุฌุงุช
            const customerId = document.getElementById('order-customer').value;
            if (!customerId) {
                Swal.fire({
                    title: 'ุฎุทุฃ',
                    text: 'ูุฑุฌู ุงุฎุชูุงุฑ ุนููู ููุทูุจ',
                    icon: 'error'
                });
                return;
            }
            
            const productItems = document.querySelectorAll('.order-product-item');
            const orderProducts = [];
            
            let isValid = true;
            productItems.forEach(item => {
                const productId = item.querySelector('.order-product-select').value;
                const quantity = parseFloat(item.querySelector('.order-product-quantity').value) || 0;
                const price = parseFloat(item.querySelector('.order-product-price').value) || 0;
                
                if (!productId || quantity <= 0 || price <= 0) {
                    isValid = false;
                    return;
                }
                
                const product = products.find(p => p.id === productId);
                
                orderProducts.push({
                    productId,
                    productName: product.name,
                    category: product.category,
                    batch: product.batch,
                    quantity,
                    price,
                    subtotal: quantity * price
                });
            });
            
            if (!isValid) {
                Swal.fire({
                    title: 'ุฎุทุฃ',
                    text: 'ูุฑุฌู ููุก ุฌููุน ุชูุงุตูู ุงูููุชุฌุงุช ุจุดูู ุตุญูุญ',
                    icon: 'error'
                });
                return;
            }
            
            const orderId = document.getElementById('order-id').value;
            const orderNumber = document.getElementById('order-number').value;
            const date = document.getElementById('order-date').value;
            const paymentMethod = document.getElementById('order-payment-method').value;
            const notes = document.getElementById('order-notes').value;
            
            const subtotal = parseFloat(document.getElementById('order-subtotal').textContent.replace(' ุฌ.ู', ''));
            const discountAmount = parseFloat(document.getElementById('order-discount').textContent.replace(' ุฌ.ู', ''));
            const totalAfterDiscount = parseFloat(document.getElementById('order-total').textContent.replace(' ุฌ.ู', ''));
            
            const hasDeposit = document.getElementById('has-deposit').checked;
            const depositAmount = hasDeposit ? parseFloat(document.getElementById('deposit-amount').value) || 0 : 0;
            const depositMethod = hasDeposit ? document.getElementById('deposit-method').value : '';
            
            // ุงูุญุตูู ุนูู ุจูุงูุงุช ุงูุนููู
            const customer = customers.find(c => c.id === customerId);
            
            const orderData = {
                orderNumber,
                date,
                customerId,
                customerName: customer.name,
                customerDiscount: customer.discount,
                products: orderProducts,
                subtotal,
                discountAmount,
                totalAfterDiscount,
                paymentMethod,
                notes,
                hasDeposit,
                depositAmount,
                depositMethod,
                updatedAt: firebase.firestore.Timestamp.now()
            };
            
            try {
                if (orderId) {
                    // ุชุญุฏูุซ ุทูุจ ููุฌูุฏ
                    await db.collection('orders').doc(orderId).update(orderData);
                    console.log('ุชู ุชุญุฏูุซ ุงูุทูุจ ุจูุฌุงุญ');
                    Swal.fire({
                        title: 'ุชู ุงูุชุญุฏูุซ',
                        text: 'ุชู ุชุญุฏูุซ ุงูุทูุจ ุจูุฌุงุญ',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                } else {
                    // ุฅุถุงูุฉ ุทูุจ ุฌุฏูุฏ
                    orderData.createdAt = firebase.firestore.Timestamp.now();
                    await db.collection('orders').add(orderData);
                    console.log('ุชู ุฅุถุงูุฉ ุงูุทูุจ ุจูุฌุงุญ');
                    Swal.fire({
                        title: 'ุชูุช ุงูุฅุถุงูุฉ',
                        text: 'ุชู ุฅุถุงูุฉ ุงูุทูุจ ุจูุฌุงุญ',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                }
                
                // ุฅุนุงุฏุฉ ุชุญููู ุงูุทูุจุงุช ูุฅุบูุงู ุงููุงูุฐุฉ ุงูููุจุซูุฉ
                loadOrders();
                document.getElementById('order-modal').classList.add('hidden');
                
            } catch (error) {
                console.error('ุฎุทุฃ ูู ุญูุธ ุงูุทูุจ:', error);
                Swal.fire({
                    title: 'ุฎุทุฃ',
                    text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญูุธ ุงูุทูุจ',
                    icon: 'error'
                });
            }
        });
        
        function getNextOrderNumber() {
            if (orders.length === 0) {
                return '10001';
            }
            
            // ุงูุจุญุซ ุนู ุฃูุจุฑ ุฑูู ุทูุจ
            const orderNumbers = orders.map(order => parseInt(order.orderNumber));
            const maxOrderNumber = Math.max(...orderNumbers);
            
            return (maxOrderNumber + 1).toString();
        }
        
        function viewOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                // ุนุฑุถ ุชูุงุตูู ุงูุทูุจ ูู ูุงูุฐุฉ ููุจุซูุฉ
                let productsHtml = '';
                order.products.forEach(product => {
                    productsHtml += `
                    <tr>
                        <td class="border px-4 py-2">${product.productName}</td>
                        <td class="border px-4 py-2">${product.batch}</td>
                        <td class="border px-4 py-2">${product.quantity}</td>
                        <td class="border px-4 py-2">${product.price} ุฌ.ู</td>
                        <td class="border px-4 py-2">${product.subtotal} ุฌ.ู</td>
                    </tr>
                    `;
                });
                
                const customer = customers.find(c => c.id === order.customerId);
                
                Swal.fire({
                    title: `ุชูุงุตูู ุงูุทูุจ ุฑูู ${order.orderNumber}`,
                    html: `
                    <div class="text-right">
                        <div class="mb-4">
                            <strong>ุงูุชุงุฑูุฎ:</strong> ${new Date(order.date).toLocaleDateString('ar-EG')}
                        </div>
                        <div class="mb-4">
                            <strong>ุงูุนููู:</strong> ${customer ? customer.name : 'ุบูุฑ ูุนุฑูู'}<br>
                            <strong>ุงููุงุชู:</strong> ${customer ? customer.phone : ''}<br>
                            <strong>ุงูุนููุงู:</strong> ${customer ? customer.address : ''}
                        </div>
                        <div class="mb-4">
                            <strong>ุทุฑููุฉ ุงูุฏูุน:</strong> ${order.paymentMethod}
                        </div>
                        <div class="mb-4">
                            <table class="w-full border-collapse">
                                <thead>
                                    <tr>
                                        <th class="border px-4 py-2">ุงูููุชุฌ</th>
                                        <th class="border px-4 py-2">ุงูููู/ุงูุจุงุชุด</th>
                                        <th class="border px-4 py-2">ุงููููุฉ</th>
                                        <th class="border px-4 py-2">ุงูุณุนุฑ</th>
                                        <th class="border px-4 py-2">ุงูุฅุฌูุงูู</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${productsHtml}
                                </tbody>
                            </table>
                        </div>
                        <div class="flex justify-between my-2">
                            <span>ุงููุจูุบ ูุจู ุงูุฎุตู:</span>
                            <strong>${order.subtotal} ุฌ.ู</strong>
                        </div>
                        <div class="flex justify-between my-2">
                            <span>ุงูุฎุตู (${customer ? customer.discount : 0}%):</span>
                            <strong>${order.discountAmount} ุฌ.ู</strong>
                        </div>
                        ${order.hasDeposit ? `
                        <div class="flex justify-between my-2">
                            <span>ุงูุนุฑุจูู (${order.depositMethod}):</span>
                            <strong>${order.depositAmount} ุฌ.ู</strong>
                        </div>
                        ` : ''}
                        <div class="flex justify-between my-2 text-lg font-bold">
                            <span>ุงููุจูุบ ุงูููุงุฆู:</span>
                            <strong>${order.totalAfterDiscount} ุฌ.ู</strong>
                        </div>
                        ${order.notes ? `
                        <div class="mt-4 p-2 bg-gray-100 rounded">
                            <strong>ููุงุญุธุงุช:</strong><br>
                            ${order.notes}
                        </div>
                        ` : ''}
                    </div>
                    `,
                    width: '800px',
                    showCancelButton: true,
                    confirmButtonText: 'ุทุจุงุนุฉ',
                    cancelButtonText: 'ุฅุบูุงู'
                }).then((result) => {
                    if (result.isConfirmed) {
                        printOrder(order);
                    }
                });
            }
        }
        
        function editOrder(orderId) {
            const order = orders.find(o => o.id === orderId);
            if (order) {
                document.getElementById('order-id').value = order.id;
                document.getElementById('order-number').value = order.orderNumber;
                document.getElementById('order-date').value = order.date;
                document.getElementById('order-customer').value = order.customerId;
                document.getElementById('order-payment-method').value = order.paymentMethod;
                document.getElementById('order-notes').value = order.notes || '';
                
                const hasDeposit = order.hasDeposit || false;
                document.getElementById('has-deposit').checked = hasDeposit;
                
                const depositSection = document.getElementById('deposit-section');
                if (hasDeposit) {
                    depositSection.classList.remove('hidden');
                    document.getElementById('deposit-amount').value = order.depositAmount || 0;
                    document.getElementById('deposit-method').value = order.depositMethod || 'ููุฏู';
                } else {
                    depositSection.classList.add('hidden');
                    document.getElementById('deposit-amount').value = 0;
                }
                
                // ุชุญุฏูุซ ููุชุฌุงุช ุงูุทูุจ
                const orderProductsContainer = document.getElementById('order-products');
                orderProductsContainer.innerHTML = '';
                
                order.products.forEach(product => {
                    const productItem = document.createElement('div');
                    productItem.className = 'order-product-item bg-gray-50 dark:bg-gray-700 p-3 rounded-md mb-2';
                    productItem.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                        <div class="md:col-span-2">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูููุชุฌ</label>
                            <select class="order-product-select w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" required>
                                <option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงููููุฉ</label>
                            <input type="number" class="order-product-quantity w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" value="${product.quantity}" min="1" required>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-200 mb-1">ุงูุณุนุฑ</label>
                            <input type="number" class="order-product-price w-full px-4 py-2 border border-gray-300 dark:border-gray-600 dark:bg-gray-700 rounded-md text-base focus:outline-none focus:ring-2 focus:ring-primary" value="${product.price}" readonly>
                        </div>
                        
                        <div class="flex items-end">
                            <button type="button" class="remove-product-item bg-red-500 text-white py-2 px-3 rounded-md font-medium hover:bg-red-600 transition-all">
                                ุญุฐู
                            </button>
                        </div>
                    </div>
                    `;
                    
                    orderProductsContainer.appendChild(productItem);
                    
                    // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุชุฌุงุช ูุชุญุฏูุฏ ุงูููุชุฌ ุงููุฎุชุงุฑ
                    const productSelect = productItem.querySelector('.order-product-select');
                    updateProductSelectOptions(productSelect);
                    productSelect.value = product.productId;
                });
                
                // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ููุญููู
                addOrderProductEventListeners();
                
                // ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุฅุฌูุงููุงุช
                calculateOrderTotals();
                
                document.getElementById('order-modal-title').textContent = 'ุชุนุฏูู ุงูุทูุจ';
                document.getElementById('order-modal').classList.remove('hidden');
            }
        }
        
        function deleteOrder(orderId) {
            Swal.fire({
                title: 'ูู ุฃูุช ูุชุฃูุฏุ',
                text: 'ูู ุชุชููู ูู ุงุณุชุนุงุฏุฉ ูุฐุง ุงูุทูุจ!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'ูุนูุ ุงุญุฐูู!',
                cancelButtonText: 'ุฅูุบุงุก'
            }).then((result) => {
                if (result.isConfirmed) {
                    db.collection('orders').doc(orderId).delete()
                        .then(() => {
                            console.log('ุชู ุญุฐู ุงูุทูุจ ุจูุฌุงุญ');
                            loadOrders();
                            Swal.fire({
                                title: 'ุชู ุงูุญุฐู!',
                                text: 'ุชู ุญุฐู ุงูุทูุจ ุจูุฌุงุญ.',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            });
                        })
                        .catch((error) => {
                            console.error('ุฎุทุฃ ูู ุญุฐู ุงูุทูุจ:', error);
                            Swal.fire({
                                title: 'ุฎุทุฃ',
                                text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงูุทูุจ',
                                icon: 'error'
                            });
                        });
                }
            });
        }
        
        function printOrder(order) {
            // ูููู ุฅุถุงูุฉ ุทุจุงุนุฉ ุงููุงุชูุฑุฉ ููุง ูู ุงููุณุชูุจู ุจุงุณุชุฎุฏุงู jsPDF
            Swal.fire({
                title: 'ุชูุจูู',
                text: 'ููุฒุฉ ุงูุทุจุงุนุฉ ููุฏ ุงูุชุทููุฑ.',
                icon: 'info'
            });
        }
        
        // ุชุญุฏูุซ ุฎูุงุฑุงุช ุงูููุชุฌุงุช ูู ูููุฐุฌ ุงูุทูุจ
        function updateProductOptions() {
            const productSelects = document.querySelectorAll('.order-product-select');
            productSelects.forEach(select => {
                updateProductSelectOptions(select);
            });
        }
        
        function updateProductSelectOptions(select) {
            // ุญูุธ ุงููููุฉ ุงููุญุฏุฏุฉ ุงูุญุงููุฉ
            const currentValue = select.value;
            
            // ูุณุญ ุงูุฎูุงุฑุงุช ุงูุญุงููุฉ
            select.innerHTML = '<option value="">ุงุฎุชุฑ ุงูููุชุฌ</option>';
            
            // ูุฑุฒ ุงูููุชุฌุงุช ุญุณุจ ุงููุฆุฉ ุซู ุงูุงุณู
            const sortedProducts = [...products].sort((a, b) => {
                if (a.category !== b.category) {
                    return a.category.localeCompare(b.category);
                }
                if (a.name !== b.name) {
                    return a.name.localeCompare(b.name);
                }
                return a.batch.localeCompare(b.batch);
            });
            
            // ุฅูุดุงุก ูุฌููุนุงุช ูููุฆุงุช
            const categories = [...new Set(sortedProducts.map(p => p.category))];
            
            categories.forEach(category => {
                const group = document.createElement('optgroup');
                group.label = category;
                
                const categoryProducts = sortedProducts.filter(p => p.category === category);
                
                categoryProducts.forEach(product => {
                    const option = document.createElement('option');
                    option.value = product.id;
                    option.textContent = `${product.name} - ${product.batch} (${product.price} ุฌ.ู)`;
                    option.dataset.price = product.price;
                    group.appendChild(option);
                });
                
                select.appendChild(group);
            });
            
            // ุงุณุชุนุงุฏุฉ ุงููููุฉ ุงููุญุฏุฏุฉ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
            if (currentValue && products.some(p => p.id === currentValue)) {
                select.value = currentValue;
            }
        }
        
        // =====================
        // ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
        // =====================
        function loadUsers() {
            // ุงูุชุญูู ูู ุฃู ุงููุณุชุฎุฏู ุงูุญุงูู ูู ุงููุณุคูู
            db.collection('users').doc(currentUser.uid).get().then((doc) => {
                if (doc.exists && doc.data().role === 'admin') {
                    // ุฌูุจ ูุงุฆูุฉ ุงููุณุชุฎุฏููู
                    db.collection('users').get().then((querySnapshot) => {
                        users = [];
                        querySnapshot.forEach((doc) => {
                            users.push({ id: doc.id, ...doc.data() });
                        });
                        
                        renderUsersTable();
                    }).catch((error) => {
                        console.error('ุฎุทุฃ ูู ุฌูุจ ุงููุณุชุฎุฏููู:', error);
                    });
                }
            }).catch((error) => {
                console.error('ุฎุทุฃ ูู ุงูุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู:', error);
            });
        }
        
        function renderUsersTable() {
            const tableBody = document.getElementById('users-table-body');
            
            if (users.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ูุณุชุฎุฏููู ุจุนุฏ</td></tr>`;
                return;
            }
            
            let html = '';
            users.forEach(user => {
                if (user.id !== currentUser.uid) { // ูุง ุชุนุฑุถ ุงููุณุชุฎุฏู ุงูุญุงูู
                    html += `
                    <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
                        <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${user.displayName || 'ุบูุฑ ูุญุฏุฏ'}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${user.email}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">${getUserRoleText(user.role)}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-gray-500 dark:text-gray-400">
                            <button class="delete-user-btn text-red-500 hover:text-red-700" data-id="${user.id}">ุญุฐู</button>
                        </td>
                    </tr>
                    `;
                }
            });
            
            if (html === '') {
                tableBody.innerHTML = `<tr><td colspan="4" class="px-6 py-4 text-center text-gray-500 dark:text-gray-400">ูุง ููุฌุฏ ูุณุชุฎุฏููู ุขุฎุฑูู ุจุนุฏ</td></tr>`;
                return;
            }
            
            tableBody.innerHTML = html;
            
            // ุฅุถุงูุฉ ูุณุชูุนู ุงูุฃุญุฏุงุซ ูุฃุฒุฑุงุฑ ุงูุญุฐู
            document.querySelectorAll('.delete-user-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const userId = this.getAttribute('data-id');
                    deleteUser(userId);
                });
            });
        }
        
        // ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ
        document.getElementById('add-user-btn').addEventListener('click', function() {
            // ุฅุนุงุฏุฉ ุชุนููู ูููุฐุฌ ุงููุณุชุฎุฏู
            document.getElementById('user-form').reset();
            
            // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ
            document.getElementById('user-modal').classList.remove('hidden');
        });
        
        // ุญูุธ ุงููุณุชุฎุฏู
        document.getElementById('user-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const displayName = document.getElementById('user-display-name').value;
            const email = document.getElementById('user-email').value;
            const password = document.getElementById('user-password').value;
            const role = document.getElementById('user-role').value;
            
            // ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ ูู Firebase Authentication
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // ุฅุถุงูุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู ุฅูู Firestore
                    const userId = userCredential.user.uid;
                    
                    return db.collection('users').doc(userId).set({
                        displayName,
                        email,
                        role,
                        createdAt: firebase.firestore.Timestamp.now(),
                        createdBy: currentUser.uid
                    });
                })
                .then(() => {
                    console.log('ุชู ุฅุถุงูุฉ ุงููุณุชุฎุฏู ุจูุฌุงุญ');
                    loadUsers();
                    document.getElementById('user-modal').classList.add('hidden');
                    Swal.fire({
                        title: 'ุชูุช ุงูุฅุถุงูุฉ',
                        text: 'ุชู ุฅุถุงูุฉ ุงููุณุชุฎุฏู ุจูุฌุงุญ',
                        icon: 'success',
                        timer: 1500,
                        showConfirmButton: false
                    });
                })
                .catch((error) => {
                    console.error('ุฎุทุฃ ูู ุฅุถุงูุฉ ุงููุณุชุฎุฏู:', error);
                    let errorMessage = 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุถุงูุฉ ุงููุณุชุฎุฏู';
                    
                    if (error.code === 'auth/email-already-in-use') {
                        errorMessage = 'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูุณุชุฎุฏู ุจุงููุนู';
                    } else if (error.code === 'auth/invalid-email') {
                        errorMessage = 'ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุบูุฑ ุตุงูุญ';
                    } else if (error.code === 'auth/weak-password') {
                        errorMessage = 'ูููุฉ ุงููุฑูุฑ ุถุนููุฉ ุฌุฏูุง';
                    }
                    
                    Swal.fire({
                        title: 'ุฎุทุฃ',
                        text: errorMessage,
                        icon: 'error'
                    });
                });
        });
        
        // ุญุฐู ูุณุชุฎุฏู
        function deleteUser(userId) {
            Swal.fire({
                title: 'ูู ุฃูุช ูุชุฃูุฏุ',
                text: 'ูู ุชุชููู ูู ุงุณุชุนุงุฏุฉ ูุฐุง ุงููุณุชุฎุฏู!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'ูุนูุ ุงุญุฐูู!',
                cancelButtonText: 'ุฅูุบุงุก'
            }).then((result) => {
                if (result.isConfirmed) {
                    // ุญุฐู ุงููุณุชุฎุฏู ูู Firestore
                    db.collection('users').doc(userId).delete()
                        .then(() => {
                            console.log('ุชู ุญุฐู ุงููุณุชุฎุฏู ูู Firestore ุจูุฌุงุญ');
                            
                            // ููุงุญุธุฉ: ุญุฐู ุงููุณุชุฎุฏู ูู Firebase Authentication
                            // ูุชุทูุจ ุฅุนุงุฏุฉ ุงููุตุงุฏูุฉ ุฃู ุงุณุชุฎุฏุงู Admin SDK
                            // ููุฐุง ูุชุฌุงูุฒ ูุทุงู ูุฐุง ุงูุชุทุจูู
                            
                            loadUsers();
                            Swal.fire({
                                title: 'ุชู ุงูุญุฐู!',
                                text: 'ุชู ุญุฐู ุงููุณุชุฎุฏู ุจูุฌุงุญ.',
                                icon: 'success',
                                timer: 1500,
                                showConfirmButton: false
                            });
                        })
                        .catch((error) => {
                            console.error('ุฎุทุฃ ูู ุญุฐู ุงููุณุชุฎุฏู:', error);
                            Swal.fire({
                                title: 'ุฎุทุฃ',
                                text: 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงููุณุชุฎุฏู',
                                icon: 'error'
                            });
                        });
                }
            });
        }
        
        // =====================
        // ุงูุฅุญุตุงุฆูุงุช ูููุญุฉ ุงูุชุญูู
        // =====================
        function updateDashboardCounts() {
            // ุชุญุฏูุซ ุนุฏุฏ ุงูููุชุฌุงุช
            document.querySelector('#dashboard-content .grid-cols-4 > div:nth-child(4) p').textContent = products.length;
            
            // ุชุญุฏูุซ ุนุฏุฏ ุงูุนููุงุก
            document.querySelector('#dashboard-content .grid-cols-4 > div:nth-child(3) p').textContent = customers.length;
            
            // ุชุญุฏูุซ ุนุฏุฏ ุงูุทูุจุงุช
            document.querySelector('#dashboard-content .grid-cols-4 > div:nth-child(2) p').textContent = orders.length;
            
            // ุญุณุงุจ ุฅุฌูุงูู ุงููุจูุนุงุช
            let totalSales = 0;
            orders.forEach(order => {
                totalSales += parseFloat(order.totalAfterDiscount);
            });
            
            document.querySelector('#dashboard-content .grid-cols-4 > div:nth-child(1) p').textContent = totalSales.toFixed(2) + ' ุฌ.ู';
        }
        
        // =====================
        // ุงูุฏูุงู ุงููุณุงุนุฏุฉ
        // =====================
        function getUserRoleText(role) {
            switch (role) {
                case 'admin':
                    return 'ูุฏูุฑ ุงููุธุงู';
                case 'supervisor':
                    return 'ูุดุฑู';
                case 'user':
                    return 'ูุณุชุฎุฏู ุนุงุฏู';
                default:
                    return 'ุบูุฑ ูุนุฑูู';
            }
        }
        
        function getInitials(name) {
            if (!name) return '';
            
            const parts = name.split(/\s+/);
            if (parts.length === 1) {
                return parts[0].charAt(0).toUpperCase();
            }
            
            return (parts[0].charAt(0) + parts[parts.length - 1].charAt(0)).toUpperCase();
        }
    </script>
</body>
</html>
